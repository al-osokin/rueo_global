# Этап 2: Реализация полнотекстового поиска

**Цель:** Предоставить пользователям возможность поиска по всему тексту словарных статей.

### Шаг 2.1: Подготовка данных для индексации

- **2.1.1.** Создать в таблице `artikoloj` новое текстовое поле, например, `full_text_content`.
- **2.1.2.** Доработать Python-импортер (из Этапа 1), добавив в него функцию "нормализации" текста для поиска:
    - Замена тильды (`~`) на соответствующую часть заголовочного слова.
    - Раскрытие синонимов, записанных через запятую (`страстно, горячо любить` -> `страстно любить, горячо любить`).
    - Раскрытие скобок с вариантами (`(любовное) увлечение` -> `увлечение, любовное увлечение`).
    - Удаление знаков ударения (` ` `) и других нетекстовых символов.
    - Приведение всего текста к нижнему регистру.
- **2.1.3.** При импорте данных заполнять поле `full_text_content` нормализованным текстом.

### Шаг 2.2: Настройка индекса в PostgreSQL

- **2.2.1.** Создать GIN-индекс по полю `full_text_content` с использованием `tsvector`.
- **2.2.2.** Настроить конфигурацию полнотекстового поиска для русского и, возможно, эсперанто, чтобы обеспечить стемминг (поиск по основе слова).

### Шаг 2.3: Разработка API

- **2.3.1.** В FastAPI создать новый endpoint, например, `/api/v1/full-text-search`.
- **2.3.2.** Endpoint должен принимать поисковый запрос (`query`) и, возможно, параметры пагинации (`page`, `limit`).
- **2.3.3.** Реализовать логику поиска в базе данных с использованием функции `to_tsquery`.
- **2.3.4.** API должен возвращать список найденных статей (например, `art_id`, заголовочное слово и, возможно, фрагмент текста, где найдено совпадение).

### Шаг 2.4: Интеграция с фронтендом

- **2.4.1.** На стороне фронтенда (`rueo_fronto`) добавить новый элемент интерфейса для полнотекстового поиска.
- **2.4.2.** Реализовать отправку запросов на новый API и отображение результатов пользователю.
