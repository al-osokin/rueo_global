# Workflow: rueo prod/stage (Stage I vs Stage II)

## Ключевая идея

- `~/rueo_master` (ветка `master`) = **прод / Stage I**. Тут правим всё общее и то, что реально используется сайтом.
- `~/rueo_global` (ветка `feature/Stage_II`) = **стейдж / Stage II**. Тут развиваем **только** код, который относится к парсингу для полнотекстового поиска и семантическому разбору.

## Зоны ответственности (грубое правило)

### ДОЛЖНО совпадать между Stage I и Stage II
- Импорт “сырого” исходного текста в БД (парсинг файлов в базу) — не трогаем в Stage II.
- Backend-слой поиска/выдачи слов фронтенду — если нашли баг, фикс делаем в Stage I.
- Всё, что обслуживает текущий прод (API, модели, миграции, деплой) — сначала Stage I.

### МОЖЕТ отличаться в Stage II
- Парсер и связанные сервисы, которые строят данные/индексы для полнотекстового поиска.
- Экспериментальная логика разрешения неоднозначности.

## Правило внесения правок

1. **Общее/прод/поиск/выдача/багфикс** → сначала делаем в `~/rueo_master`.
2. Сразу после этого: **backport в Stage II** (в `~/rueo_global`) через `git cherry-pick` (предпочтительно) или `merge`.
3. **Stage II-специфичное (парсер для FTS/семантика)** → делаем только в `~/rueo_global`, обратно в Stage I не переносим, пока не будет отдельного решения.

## Минимальная дисциплина документации (в стиле OpenSpec, но без обязаловки)

На каждую нетривиальную правку заводим файл-план в `memory-bank/tasks/` по шаблону.
- До кода: записать “Почему/Что меняем/Критерии готовности”.
- Во время: отмечать чекбоксы.
- После: записать “Итог” + “Как проверить” + “Backport выполнен (SHA)”.

Шаблон: `memory-bank/tasks/_TEMPLATE.md`.
